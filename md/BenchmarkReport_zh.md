# Go ORM 框架基准测试报告

[中文版](BenchmarkReport_zh.md "访问中文版")

[English](BenchmarkReport_en.md "Access English Version")

## 概述
本文档对比了三个 Go 语言 ORM 框架（GORM、XLORM 和 XORM）在不同操作场景下的性能表现。测试包括插入、批量插入、查询、批量查询、更新、批量更新、删除和事务操作。测试环境为 Windows 系统，AMD64 架构，使用 Intel(R) Core(TM) i5-7500 CPU @ 3.40GHz。

## 测试结果对比

### 1. 插入操作
| 框架   | 测试用例          | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|-------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_Insert-4 | 1747    | 679999               | 4798            | 63                   | -             |
| XLORM  | BenchmarkInsert-4      | 2035    | 557139               | 1097            | 28                   | 81.8 / 23.3 / 44.4 |
| XORM   | BenchmarkXORM_Insert-4 | 1951    | 581697               | 2259            | 43                   | 85.5 / 47.1 / 68.3 |

### 2. 批量插入操作
| 框架   | 测试用例              | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|-----------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_BatchInsert-4 | 1636   | 709971               | 6595            | 89                   | -             |
| XLORM  | BenchmarkBatchInsert-4      | 1614   | 714198               | 2639            | 64                   | 100.6 / 40.0 / 72.0 |
| XORM   | BenchmarkXORM_BatchInsert-4 | 1864   | 620709               | 3638            | 85                   | 87.4 / 55.1 / 95.5 |

### 3. 查询操作
| 框架   | 测试用例          | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|-------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_Find-4 | 6344    | 192686               | 4155            | 64                   | -             |
| XLORM  | BenchmarkFind-4      | 5638    | 190575               | 2748            | 51                   | 99.0 / 66.1 / 79.7 |
| XORM   | BenchmarkXORM_Find-4 | 5640    | 203428               | 4274            | 116                  | 98.4 / 102.9 / 181.3 |

### 4. 批量查询操作
| 框架   | 测试用例              | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|-----------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_FindAll-4 | 584     | 2000131              | 4864            | 62                   | -             |
| XLORM  | BenchmarkFindAll-4      | 608     | 1940781              | 2471            | 37                   | 97.0 / 50.8 / 59.7 |
| XORM   | BenchmarkXORM_FindAll-4 | 619     | 1986661              | 3882            | 86                   | 106.0 / 79.8 / 138.7 |

### 5. 更新操作
| 框架   | 测试用例          | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|-------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_Update-4 | 1506   | 833433               | 6103            | 69                   | -             |
| XLORM  | BenchmarkUpdate-4      | 1695    | 696792               | 1276            | 27                   | 83.6 / 20.9 / 39.1 |
| XORM   | BenchmarkXORM_Update-4 | 6212    | 183031               | 2577            | 64                   | 41.2 / 42.2 / 92.8 |

### 6. 批量更新操作
| 框架   | 测试用例              | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|-----------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_BatchUpdate-4 | 681    | 1746530              | 13378           | 167                  | -             |
| XLORM  | BenchmarkBatchUpdate-4      | 1390   | 806534               | 3924            | 63                   | 119.1 / 29.3 / 37.7 |
| XORM   | BenchmarkXORM_BatchUpdate-4 | 1027   | 1244602              | 6201            | 160                  | 71.3 / 46.3 / 95.8 |

### 7. 删除操作
| 框架   | 测试用例          | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|-------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_Delete-4 | 4236   | 278541               | 5302            | 62                   | -             |
| XLORM  | BenchmarkDelete-4      | 7189    | 170216               | 957             | 20                   | 169.7 / 61.1 / 32.3 |
| XORM   | BenchmarkXORM_Delete-4 | 6818    | 178486               | 2600            | 69                   | 161.0 / 49.0 / 111.3 |

### 8. 事务操作
| 框架   | 测试用例                  | 运行次数 | 每次运行时间 (ns/op) | 内存分配 (B/op) | 分配次数 (allocs/op) | 对比 GORM (%) |
|--------|---------------------------|----------|----------------------|-----------------|----------------------|---------------|
| GORM   | BenchmarkGORM_Transaction-4 | 1572   | 751466               | 5893            | 65                   | -             |
| XLORM  | BenchmarkTransaction-4      | 1508    | 823494               | 2686            | 79                   | 95.9 / 110.0 / 121.5 |
| XORM   | BenchmarkXORM_Transaction-4 | 1626    | 728734               | 3149            | 66                   | 103.4 / 53.4 / 101.5 |

## 总结
- **性能表现**：
  - **XLORM**：在大多数操作中表现出较好的性能，尤其是在**查询操作**和**删除操作**中表现突出。例如，在查询操作中，其每次运行时间比 GORM 快约 1%，内存分配量仅为 GORM 的约 66%，分配次数也更少。在删除操作中，其运行速度比 GORM 快约 69.7%，内存分配量仅为 GORM 的约 61.1%。
  - **XORM**：在**更新操作**中表现最佳，其每次运行时间仅为 GORM 的约 41.2%，内存分配量也更少。此外，在批量插入操作中，XORM 的内存分配量和分配次数也优于 GORM。
  - **GORM**：在**事务操作**中表现较为稳定，运行时间、内存分配和分配次数均处于中等水平，适合需要复杂事务管理的应用。

- **内存分配**：
  - **XLORM** 在内存分配方面表现最佳，通常具有较低的内存分配量和分配次数。例如，在插入操作中，其内存分配量仅为 GORM 的约 23.3%，分配次数仅为 GORM 的约 44.4%。
  - **XORM** 的内存分配量也相对较低，但在某些操作中略高于 XLORM。例如，在批量更新操作中，XORM 的内存分配量为 GORM 的约 46.3%。

- **适用场景**：
  - 如果项目中频繁涉及**查询操作**和**删除操作**，**XLORM** 是一个不错的选择，因为它在这些操作中表现出较高的性能和较低的内存分配。
  - 对于需要高效**更新操作**的场景，**XORM** 更为适合，因为它在更新操作中表现出最佳性能。
  - **GORM** 在事务处理方面表现稳定，适合需要复杂事务管理的应用。此外，GORM 的社区支持和功能完整性也使其成为一个可靠的选择。

以上对比基于本次基准测试结果，实际使用时还需结合具体业务需求和框架的其他特性（如易用性、功能完整性、社区支持等）进行综合评估。
